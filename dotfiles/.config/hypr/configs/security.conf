#   
#   
#     /$$$$$$  /$$$$$$$$  /$$$$$$  /$$   /$$ /$$$$$$$  /$$$$$$ /$$$$$$$$ /$$     /$$
#    /$$__  $$| $$_____/ /$$__  $$| $$  | $$| $$__  $$|_  $$_/|__  $$__/|  $$   /$$/
#   | $$  \__/| $$      | $$  \__/| $$  | $$| $$  \ $$  | $$     | $$    \  $$ /$$/ 
#   |  $$$$$$ | $$$$$   | $$      | $$  | $$| $$$$$$$/  | $$     | $$     \  $$$$/  
#    \____  $$| $$__/   | $$      | $$  | $$| $$__  $$  | $$     | $$      \  $$/   
#    /$$  \ $$| $$      | $$    $$| $$  | $$| $$  \ $$  | $$     | $$       | $$    
#   |  $$$$$$/| $$$$$$$$|  $$$$$$/|  $$$$$$/| $$  | $$ /$$$$$$   | $$       | $$    
#    \______/ |________/ \______/  \______/ |__/  |__/|______/   |__/       |__/    
#   
#   




# === SECURITY & PERMISSIONS ===
ecosystem {
    enforce_permissions = 1
}

# === SCREENSHOT TOOLS ===
permission = /usr/(bin|local/bin)/grim, screencopy, allow
permission = /usr/(bin|local/bin)/slurp, screencopy, allow
permission = /usr/(bin|local/bin)/wayshot, screencopy, allow
permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow

# === SCREEN RECORDING ===
permission = /usr/(bin|local/bin)/wf-recorder, screencopy, allow
permission = /usr/(bin|local/bin)/obs, screencopy, allow
permission = /usr/(bin|local/bin)/ffmpeg, screencopy, allow
permission = /usr/(bin|local/bin)/kazam, screencopy, allow

# === CLIPBOARD MANAGEMENT ===
# Hyprland only supports 'screencopy' permission type for now
permission = /usr/(bin|local/bin)/cliphist, screencopy, allow
permission = /usr/(bin|local/bin)/wl-copy, screencopy, allow
permission = /usr/(bin|local/bin)/wl-paste, screencopy, allow
permission = /usr/(bin|local/bin)/copyq, screencopy, allow

# === SYSTEM UTILITIES ===
permission = /usr/(bin|local/bin)/hyprpm, screencopy, allow
permission = /usr/(bin|local/bin)/hyprctl, screencopy, allow
permission = /usr/(bin|local/bin)/systemctl, screencopy, allow

# === LOCK SCREEN ===
permission = /usr/(bin|local/bin)/hyprlock, screencopy, allow
permission = /usr/(bin|local/bin)/swaylock, screencopy, allow
permission = /usr/(bin|local/bin)/gtklock, screencopy, allow

# === FILE MANAGERS & PORTALS ===
permission = /usr/(bin|local/bin)/nautilus, screencopy, allow
permission = /usr/(bin|local/bin)/thunar, screencopy, allow
permission = /usr/(bin|local/bin)/dolphin, screencopy, allow
permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-gtk, screencopy, allow
permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-kde, screencopy, allow

# === BROWSERS ===
permission = /usr/(bin|local/bin)/firefox, screencopy, allow
permission = /usr/(bin|local/bin)/chromium, screencopy, allow
permission = /usr/(bin|local/bin)/google-chrome-stable, screencopy, allow

# === INPUT & ACCESSIBILITY ===
permission = /usr/(bin|local/bin)/fcitx5, screencopy, allow
permission = /usr/(bin|local/bin)/ibus-daemon, screencopy, allow
permission = /usr/(bin|local/bin)/onboard, screencopy, allow

# === RESTRICTIVE PERMISSIONS (SECURITY) ===
# Deny screen access to unknown applications by default
permission = .*, screencopy, deny

# === TRUSTED PATHS ===
# Allow applications from system directories (ask for permission)
permission = /usr/bin/.*, screencopy, ask
permission = /usr/local/bin/.*, screencopy, ask
permission = /bin/.*, screencopy, ask

# === SPECIFIC DENY RULES ===
# Deny potentially risky applications
permission = .*/tmp/.*, screencopy, deny
permission = .*/dev/shm/.*, screencopy, deny
permission = .*\.(sh|bash|zsh)$, screencopy, deny

# === SECURITY ENHANCEMENTS ===
# Environment variable for additional security
env = XDG_SESSION_TYPE,wayland
env = MOZ_ENABLE_WAYLAND,1
env = QT_QPA_PLATFORM,wayland
env = GDK_BACKEND,wayland

# === PERMISSION HIERARCHY ===
# Rules are processed in order - put specific rules before generic ones
# Later rules override earlier ones for the same path pattern
